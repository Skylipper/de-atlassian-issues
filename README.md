# Проект по агрегированию данных из публичной облачной JIRA компании ATLASSIAN
Идея проекта заключается в получении информации о задачах в трекере за большой период времени через REST API и построении витрин и визуализаций на основе этих данных.

## Что проверяем:

1. Действительно ли для серверных версий продукта, отмеченных как LTS, количество багов, зарегистрированных пользователями меньше, чем для не-LTS.
2. Действительно ли ATLASSIAN отдает приоритет задачам, относящимся к Cloud.
3. Действительно ли количество голосов за улучшение может повлиять на внедрение функциональности.

## Планируемая реализация

### Технологический стэк
Python - основной язык программирования (+ pandas)

Apache Airflow - оркестратор для пайплайнов обработки данных.

PostgreSQL - СУБД для организации слоев STG, ODS и DDS слоев.

СlickHouse - аналитическая СУБД для CDM слоя

DataLens - визуализация.

### Описание пайплайна
##### Загрузка в STG
STG слой расположен в отдельной схеме на БД под управлением PostgreSQL.

Схема слоя:
![alt text](https://github.com/Skylipper/de-atlassian-issues/blob/main/docs/images/db_scheme/1_stg.png)

Таблицы не имеют внешних ключей, проверяется уникальность ID. 
При обновлении объекта данные перезаписываются.
Нужна поддержка идемпотентности.

1. Через запросы к REST API получить информацию о вспомогательных сущностях проектов и задач: поля задач (id, name, options), свойства проектов (компоненты, версии и т.п.)
2. Загрузка информации об LTS версиях (пока непонятен источник, надо исследовать, крайние варианты: парсинг html страницы с версиями, либо ручное формирование сsv файла)
3. Загрузка доступных задач через REST API: сначала через JQL-фильтр (нужны два проекта JRACLOUD и JRASERVER) получаем список нужных задач, потом, итерируясь по этому списку, вытягиваем подробную информацию.
Есть ограничения на количество запросов в минуту, нужно использовать paging и контролировать коды ответов.

Загрузка будет происходить as is, инкрементально (проверка по дате Update), с записью дат успешных выгрузок во вспомогательную таблицу в этой же схеме.

Первоначальная загрузка данных займет много времени из-за большого количества данных и ограничений в обращениях к REST API.

#### Загрузка в ODS
ODS слой расположен в отдельной схеме на БД под управлением PostgreSQL.
Таблицы не имеют внешних ключей, проверяется уникальность ID. 
Данные очищаются от дублей, некорректных значений.
При обновлении объекта данные перезаписываются (UPSERT).
Нужна поддержка идемпотентности.

На этом этапе разбираем полученные JSON объекты, очищаем данные и раскладываем их по соотвествующим таблицам.
Загрузка будет происходить инкрементально, с записью дат успешных выгрузок во вспомогательную таблицу в этой же схеме.

#### Загрузка в DDS
DDS слой расположен в отдельной схеме на БД под управлением PostgreSQL.
Создаются таблицы по модели звезда или снежинка, приближенной к 3НФ с внешними ключами, ограничениями и проверками данных.
При обновлении объекта данные перезаписываются (UPSERT).
Нужна поддержка идемпотентности.

#### Построение витрин в CDM
CDM слой расположен в отдельной схеме на БД под управлением ClickHouse (облачный, на Yandex Cloud).
Строим несколько витрин на полученных данных
1. Зависимость количества найденных багов по LTS и не-LTS релизам за настраиваемый 
2. Скорость закрытия задач за период в разрезе Cloud - DC.
3. Зависимость скорости закрытия задачи от количества голосов за задачу

#### Визуализация полученных данных



#### Примечания
Документация к REST API для облачной Atlassian JIRA - https://developer.atlassian.com/cloud/jira/platform/rest/v3/intro/#about

Информация об LTS релизах - https://www.atlassian.com/software/jira/download-archives